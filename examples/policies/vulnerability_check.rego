package security.vulnerabilities

# Rule to deny if there are critical vulnerabilities
deny[msg] {
	vuln := input[_]
	vuln.severity == "CRITICAL"
	msg := {
		"cve_id": vuln.cve_id,
		"severity": vuln.severity,
		"description": vuln.description,
		"reason": "Critical severity vulnerability found",
	}
}

# Rule to warn if there are high severity vulnerabilities
warn[msg] {
	vuln := input[_]
	vuln.severity == "HIGH"
	msg := {
		"cve_id": vuln.cve_id,
		"severity": vuln.severity,
		"description": vuln.description,
		"reason": "High severity vulnerability found",
	}
}

# Allow only if no deny or warn messages exist
allow {
	count(deny) == 0
	count(warn) == 0
}
